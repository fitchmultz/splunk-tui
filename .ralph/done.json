{
  "version": 1,
  "tasks": [
    {
      "id": "RQ-0001",
      "status": "done",
      "title": "Refactor popup UI to Builder pattern and add structured logging",
      "priority": "high",
      "tags": [
        "ui",
        "refactor",
        "logging",
        "foundation"
      ],
      "scope": [
        "crates/tui/src/ui/popup.rs",
        "crates/tui/src/app.rs",
        "crates/tui/src/main.rs",
        "crates/tui/tests/snapshot_tests.rs",
        "crates/tui/tests/app_tests.rs",
        "crates/tui/src/lib.rs",
        "crates/tui/Cargo.toml",
        "crates/tui/src/ui/screens/jobs.rs",
        "crates/tui/src/action.rs",
        "crates/tui/tests/helpers.rs"
      ],
      "evidence": [
        "Plan FLIGHT 1: Foundation Refactor (Popup Builder & Observability)",
        "Objective: Execute architectural evolution to establish UI robustness"
      ],
      "plan": [
        "Modify crates/tui/src/ui/popup.rs: Implement PopupBuilder with fluent API (title, content, style, build). Replace static helper functions with flexible render method accepting Popup state.",
        "Modify crates/tui/src/app.rs: Define const values for UI layout (header height, footer height). Update Popup enum to use richer structure (Confirm {title, message, action}, Info {title, message}, Help) and integrate with Builder.",
        "Modify crates/tui/src/main.rs: Initialize tracing with subscriber that logs to file (tui interferes with stdout). Add info! logs on Action receipt for observability.",
        "Modify crates/tui/tests/snapshot_tests.rs: Update popup test fixtures to use new Builder syntax. Remove unused import: helpers::*."
      ],
      "notes": [
        "Added PopupType enum (Help, ConfirmCancel(String), ConfirmDelete(String)) and Popup struct with title, content, kind fields.",
        "Implemented PopupBuilder with fluent API (title(), content(), build()).",
        "Added layout constants: HEADER_HEIGHT = 3, FOOTER_HEIGHT = 3, POPUP_WIDTH_PERCENT = 60, POPUP_HEIGHT_PERCENT = 20.",
        "Refactored render_popup() to use Popup struct instead of enum, extracting kind field for pattern matching.",
        "Updated all popup creation sites to use Builder pattern: Popup::builder(PopupType::Help).build().",
        "Added file-based logging with tracing-appender: logs/splunk-tui.log with daily rotation.",
        "Added action logging in main loop: tracing::info!(?action, \"Handling action\").",
        "Updated lib.rs to re-export Popup, PopupType, HEADER_HEIGHT, FOOTER_HEIGHT.",
        "Updated all tests to use new Builder API and match on popup.kind field.",
        "Added Default implementations for SortState and App (clippy requirements).",
        "Refactored render_jobs() to use JobsRenderConfig struct to fix clippy too_many_arguments warning.",
        "Fixed all clippy warnings (dead_code, new_without_default, too_many_arguments)."
      ],
      "request": "Read /tmp/plan.md and build out the task queue based on the plan provided.",
      "created_at": "2025-01-19T00:00:00Z",
      "updated_at": "2026-01-19T00:00:00Z",
      "completed_at": "2026-01-19T00:00:00Z",
      "depends_on": []
    },
    {
      "id": "RQ-0002",
      "status": "done",
      "title": "Implement Job Inspection details view screen",
      "priority": "high",
      "tags": [
        "ui",
        "feature",
        "inspection",
        "state"
      ],
      "scope": [
        "crates/tui/src/ui/screens/job_details.rs",
        "crates/tui/src/ui/screens/mod.rs",
        "crates/tui/src/app.rs",
        "crates/tui/src/action.rs",
        "crates/tui/src/ui/popup.rs",
        "crates/tui/tests/app_tests.rs",
        "crates/tui/tests/snapshot_tests.rs"
      ],
      "evidence": [
        "Plan FLIGHT 2: Job Inspection (Details View)",
        "Unlock data depth with detailed job inspection capability"
      ],
      "plan": [
        "Create crates/tui/src/ui/screens/job_details.rs: Implement render_details(f: &mut Frame, job: &SearchJobStatus, area: Rect). Use List or Table to show all fields of SearchJobStatus.",
        "Modify crates/tui/src/ui/screens/mod.rs: Export new job_details module.",
        "Modify crates/tui/src/action.rs: Add InspectJob and ExitScreen actions. Remove dead_code warnings for SearchInput and ToggleSortDirection by implementing usage or removing unused variants.",
        "Modify crates/tui/src/app.rs: Add JobDetails variant to CurrentScreen enum. Add selected_job: Option<SearchJobStatus> to App struct. In render(), route CurrentScreen::JobDetails to screens::job_details::render_details.",
        "Modify crates/tui/src/ui/screens/jobs.rs: In handle_input, map Enter key to Action::InspectJob."
      ],
      "notes": [
        "Created job_details.rs screen module with render_details() function displaying all SearchJobStatus fields (SID, status with color-coding, duration, event/scan/result counts, disk usage, priority, label, cursor time, finalized status).",
        "Added JobInspect variant to CurrentScreen enum in app.rs.",
        "Added InspectJob and ExitInspectMode actions to action.rs.",
        "Implemented handle_job_inspect_input() method in app.rs with Esc key to exit inspect mode.",
        "Mapped Enter key in handle_jobs_input() to trigger InspectJob action.",
        "Added render_job_details() helper method that dynamically retrieves selected job from jobs list using jobs_state.selected().",
        "Added JobInspect branch to render_content() match statement.",
        "Updated header rendering to show 'Job Details' when in JobInspect screen.",
        "Updated help popup to include 'Enter Inspect job' under Jobs Screen and 'Esc Back to jobs' under Job Details Screen.",
        "Added three state transition tests in app_tests.rs: test_job_inspection_flow, test_job_inspection_without_jobs, test_job_inspect_help_popup.",
        "Added four snapshot tests in snapshot_tests.rs: snapshot_job_details_screen_with_job, snapshot_job_details_screen_running_job, snapshot_job_details_screen_no_job, snapshot_job_details_screen_with_help_popup.",
        "All tests pass and make ci completes successfully."
      ],
      "request": "Read /tmp/plan.md and build out the task queue based on the plan provided.",
      "created_at": "2025-01-19T00:00:00Z",
      "updated_at": "2026-01-19T00:00:00Z",
      "completed_at": "2026-01-19T00:00:00Z",
      "depends_on": []
    }
  ]
}
