{
  "version": 1,
  "tasks": [
    {
      "id": "RQ-0389",
      "status": "todo",
      "title": "Add shell completions + manpage generation for splunk-cli/splunk-tui",
      "description": "Opportunity type: UX improvement\n\nEvidence:\n- `splunk-cli` and `splunk-tui` have a large clap surface area (many subcommands/options) but there is no command to generate shell completions or manpages (no `clap_complete` usage found).\n\nWhy it matters:\n- Completions reduce typos and discovery time for power users and increase automation ergonomics. Manpages enable offline help and better packaging/distribution.\n\nProposed approach:\n- Minimal slice:\n  - Add `splunk-cli completions <shell>` to print completions to stdout.\n  - Add `splunk-cli man` (or `docs`) to print a manpage for the CLI.\n  - Mirror for `splunk-tui` options if useful.\n- Add examples in `--help` showing how to install completions for bash/zsh/fish.\n\nRisks and mitigations:\n- Risk: added dependencies. Mitigation: use minimal, well-maintained clap ecosystem crates (`clap_complete`, `clap_mangen`) behind a small module boundary.\n\nAcceptance criteria:\n- `splunk-cli completions --help` and `splunk-cli man --help` include examples.\n- Tests assert the subcommands produce non-empty output and exit 0 (no network required).\n- `make test` passes.\n\nPriority rationale:\n- Medium: big ergonomic win for relatively small implementation effort.",
      "priority": "medium",
      "tags": [
        "innovation",
        "cli",
        "ux",
        "docs"
      ],
      "scope": [
        "crates/cli/src/args.rs",
        "crates/cli/src/dispatch.rs",
        "crates/cli/src/commands/",
        "make test"
      ],
      "evidence": [
        "rg -n 'clap_complete|completions|mangen' crates/cli returns no matches (no completion/man generation implemented)",
        "crates/cli/src/args.rs defines many subcommands, making completions high leverage"
      ],
      "plan": [
        "Add new clap subcommands for `completions` and `man` in `crates/cli/src/args.rs`.",
        "Implement the generators using clap's command model (no network; stdout-only).",
        "Add tests validating output is non-empty for at least one shell and man generation.",
        "Verify by running `make test` and confirming CLI tests pass."
      ],
      "notes": [],
      "request": "innovation scan finding",
      "created_at": "2026-02-07T03:33:55Z",
      "updated_at": "2026-02-07T03:33:55Z",
      "depends_on": [],
      "blocks": [],
      "relates_to": [],
      "custom_fields": {
        "scan_agent": "scan-innovation"
      }
    },
    {
      "id": "RQ-0390",
      "status": "todo",
      "title": "Add splunk-cli jobs results subcommand (paginate/export)",
      "description": "Opportunity type: feature gap / workflow coverage\n\nEvidence:\n- `splunk-cli jobs` supports list/inspect/cancel/delete, but cannot retrieve search job results by SID.\n- The client already supports fetching results for a SID with pagination (`SplunkClient::get_search_results(sid, count, offset)`).\n\nWhy it matters:\n- Job-centric workflows often start with a SID (from TUI, logs, Splunk Web). Being able to fetch results without re-running the search improves incident response and automation.\n\nProposed approach:\n- Minimal slice: add `splunk-cli jobs results <SID> [--count N] [--offset N] [-o json|table|csv|xml] [--output-file PATH]` that calls `get_search_results` and formats results via existing search result formatter.\n- Expansion: add `--all` to iterate pages until completion and stream to stdout/file; add `jobs events` later if needed.\n\nRisks and mitigations:\n- Risk: large outputs. Mitigation: default to a safe count; document `--output-file`; consider NDJSON streaming as a follow-up.\n\nAcceptance criteria:\n- CLI help includes examples and documents pagination flags.\n- Hermetic tests cover arg parsing and formatting glue; ignored live tests validate server behavior.\n- `make test` passes.\n\nPriority rationale:\n- Medium: meaningful workflow unlock with moderate effort.",
      "priority": "medium",
      "tags": [
        "innovation",
        "cli",
        "feature",
        "jobs"
      ],
      "scope": [
        "crates/cli/src/commands/jobs.rs",
        "crates/cli/src/args.rs",
        "crates/client/src/client/search.rs",
        "crates/cli/tests/",
        "make test"
      ],
      "evidence": [
        "crates/client/src/client/search.rs exposes get_search_results(sid, count, offset)",
        "docs/usage.md lists jobs list/inspect/cancel/delete examples but no results retrieval"
      ],
      "plan": [
        "Extend the CLI jobs command surface to include a `results` subcommand with count/offset/output flags.",
        "Implement handler that calls `SplunkClient::get_search_results` and formats via existing formatter.",
        "Add hermetic CLI tests for parsing + formatting integration; add `#[ignore]` live test for end-to-end.",
        "Verify by running `make test` and ensuring CLI tests pass."
      ],
      "notes": [],
      "request": "innovation scan finding",
      "created_at": "2026-02-07T03:33:55Z",
      "updated_at": "2026-02-07T03:33:55Z",
      "depends_on": [],
      "blocks": [],
      "relates_to": [],
      "custom_fields": {
        "scan_agent": "scan-innovation"
      }
    },
    {
      "id": "RQ-0391",
      "status": "todo",
      "title": "Refactor SplunkClient to allow concurrent API calls (remove TUI mutex bottleneck)",
      "description": "Opportunity type: performance / strategic refactor\n\nEvidence:\n- The TUI side-effects layer documents that all API calls are serialized behind a single `Arc<Mutex<SplunkClient>>` because client methods require `&mut self` for session refresh (`crates/tui/src/runtime/side_effects/mod.rs`).\n- CLI `list-all` explicitly fetches resources sequentially for the same reason (`crates/cli/src/commands/list_all/fetchers.rs`).\n\nWhy it matters:\n- Serialized calls increase perceived latency (slow screen loads, slow multi-resource commands) and increase the chance that background refreshes starve user-triggered actions.\n- Making the client concurrency-friendly unlocks parallel health aggregation, faster list-all, and smoother TUI refresh behavior.\n\nProposed approach:\n- Minimal viable slice:\n  - Refactor auth/session token refresh to use interior mutability so request methods can be `&self` (e.g., session manager behind an async lock with a singleflight refresh path).\n  - Update the client API surface accordingly and remove the global mutex in TUI (`Arc<SplunkClient>` instead of `Arc<Mutex<...>>`).\n  - Introduce a concurrency limit (semaphore) at the UI edge to prevent flooding Splunk.\n- Expansion:\n  - Parallelize multi-call aggregations (health aggregate, list-all resources) using `join!` with bounded concurrency.\n\nRisks and mitigations:\n- Risk: race conditions around token refresh. Mitigation: singleflight refresh with strict invariants and tests for concurrent callers.\n- Risk: wide blast radius (signature changes). Mitigation: staged refactor with clear compilation gates and workspace-wide updates.\n\nAcceptance criteria:\n- New tests covering concurrent token refresh behavior and ensuring correctness for both API-token and session-token auth.\n- Demonstrable latency reduction for health aggregation and list-all (documented benchmark or measured in a test/bench).\n- `make test` and `make ci` pass.\n\nPriority rationale:\n- Medium: hig...",
      "priority": "medium",
      "tags": [
        "innovation",
        "client",
        "tui",
        "performance",
        "refactor"
      ],
      "scope": [
        "crates/client/src/",
        "crates/tui/src/runtime/side_effects/",
        "crates/cli/src/commands/list_all/",
        "make ci"
      ],
      "evidence": [
        "crates/tui/src/runtime/side_effects/mod.rs explains all API calls serialize on Arc<Mutex<SplunkClient>> due to &mut self requirement",
        "crates/cli/src/commands/list_all/fetchers.rs:16-20 documents sequential resource fetch due to &mut SplunkClient"
      ],
      "plan": [
        "Design the new auth/session management interior-mutability model (singleflight refresh, clear invariants).",
        "Refactor `SplunkClient` methods to take `&self` where possible and update call sites across CLI/TUI.",
        "Remove the TUI shared client mutex and add bounded concurrency controls at the runtime edge.",
        "Parallelize health aggregation and list-all resource fetching with bounded concurrency.",
        "Add concurrency-focused tests (token refresh races) and update any affected public API docs.",
        "Verify by running `make ci` and confirming latency improvements via benchmarks/logs."
      ],
      "notes": [],
      "request": "innovation scan finding",
      "created_at": "2026-02-07T03:33:55Z",
      "updated_at": "2026-02-07T03:33:55Z",
      "depends_on": [],
      "blocks": [],
      "relates_to": [],
      "custom_fields": {
        "scan_agent": "scan-innovation"
      }
    },
    {
      "id": "RQ-0376",
      "status": "todo",
      "title": "Fix expect() panic in SyntaxHighlighter Default implementation",
      "description": "The Default implementation for SyntaxHighlighter in syntax.rs uses .expect() which can panic if syntax highlighting initialization fails. This should return a fallback highlighter instead of panicking, as syntax highlighting is a non-critical feature.",
      "priority": "high",
      "tags": [
        "maintenance",
        "fail-fast",
        "tui",
        "bugfix"
      ],
      "scope": [
        "crates/tui/src/ui/syntax.rs:194-197"
      ],
      "evidence": [
        "Lines 194-197: impl Default calls Self::new().expect(\"Failed to create SyntaxHighlighter\")",
        "This can panic if tree-sitter initialization fails"
      ],
      "plan": [
        "Modify Default to return a fallback highlighter with inner: None instead of panicking",
        "Ensure all methods on SyntaxHighlighter handle the None case gracefully",
        "Add test for Default implementation",
        "Verify by running: 'cargo test -p splunk-tui' and 'cargo check -p splunk-tui'"
      ],
      "notes": [],
      "request": "maintenance scan finding",
      "created_at": "2026-02-06T22:50:42Z",
      "updated_at": "2026-02-06T22:50:42Z",
      "depends_on": [],
      "blocks": [],
      "relates_to": [],
      "custom_fields": {
        "principle": "fail-fast",
        "scan_agent": "scan-maintenance"
      }
    },
    {
      "id": "RQ-0377",
      "status": "todo",
      "title": "Add SKIP_LIVE_TESTS documentation to .env.test.example",
      "description": "The SKIP_LIVE_TESTS environment variable is referenced in the Makefile but is not documented in .env.test.example. This variable allows users to skip live server tests even when a Splunk server is available. It should be documented for discoverability.",
      "priority": "low",
      "tags": [
        "maintenance",
        "documentation",
        "configuration"
      ],
      "scope": [
        ".env.test.example"
      ],
      "evidence": [
        "Makefile references SKIP_LIVE_TESTS in test-live target",
        ".env.test.example does not mention this variable"
      ],
      "plan": [
        "Add SKIP_LIVE_TESTS=1 comment to .env.test.example with description",
        "Verify the variable is mentioned consistently with Makefile behavior"
      ],
      "notes": [],
      "request": "maintenance scan finding",
      "created_at": "2026-02-06T22:50:42Z",
      "updated_at": "2026-02-06T22:50:42Z",
      "depends_on": [],
      "blocks": [],
      "relates_to": [],
      "custom_fields": {
        "scan_agent": "scan-maintenance",
        "principle": "KISS"
      }
    }
  ]
}