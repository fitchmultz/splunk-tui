{
  "version": 1,
  "tasks": [
    {
      "id": "RQ-0105",
      "status": "todo",
      "title": "Make Help popup scrollable, left-aligned, and derived from actual keymap",
      "priority": "high",
      "tags": [
        "tui",
        "ux",
        "keybindings",
        "help"
      ],
      "scope": [
        "crates/tui/src/ui/popup.rs",
        "crates/tui/tests/snapshot_tests.rs",
        "crates/tui/src/app.rs"
      ],
      "evidence": [
        "crates/tui/src/ui/popup.rs: Help content is a long static string rendered via Paragraph with center alignment and no scroll support, so it will truncate on typical terminal sizes.",
        "crates/tui/tests/snapshot_tests.rs: snapshot_help_popup asserts a specific help rendering, so keymap changes require coordinated updates and better structure.",
        "crates/tui/src/app.rs: help popup is opened via KeyCode::Char('?') in many handlers, but help content is not generated from those handlers, enabling drift."
      ],
      "plan": [
        "Change help popup rendering to support scrolling (similar to error details popup) and left-align the content for readability.",
        "Generate help content from a centralized keymap definition (or at least a single source of truth) to prevent drift.",
        "Update snapshot tests for help (and add a smaller-terminal snapshot) to ensure content remains accessible.",
        "Verify all help-close keys still work after keymap changes."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0115",
      "status": "todo",
      "title": "Add per-screen footer hints (discoverability without opening Help)",
      "priority": "medium",
      "tags": [
        "tui",
        "ux",
        "keybindings",
        "polish"
      ],
      "scope": [
        "crates/tui/src/app.rs",
        "crates/tui/tests/snapshot_tests.rs"
      ],
      "evidence": [
        "crates/tui/src/app.rs: footer currently shows only screen navigation and q:Quit, even though each screen has multiple important shortcuts (refresh/export/filter/etc).",
        "crates/tui/src/ui/popup.rs: help content is long and modal; relying on it for basic discovery contributes to a \"rudimentary\" feel.",
        "docs/usage.md: screen-specific shortcuts exist but are not surfaced in-app except via the help popup."
      ],
      "plan": [
        "Define a small per-screen hint set (3-6 keys) and render it in the footer alongside navigation.",
        "Ensure hints adapt when in text-input modes (e.g., Search Query focus vs Results focus).",
        "Add snapshots for a few screens to lock in the footer hint layout across themes and terminal sizes."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0109",
      "status": "todo",
      "title": "Fix footer mouse hit-testing (dynamic offsets, loading % width, small terminals)",
      "priority": "medium",
      "tags": [
        "tui",
        "ux",
        "mouse",
        "bug"
      ],
      "scope": [
        "crates/tui/src/app.rs",
        "crates/tui/src/ui/mod.rs",
        "crates/tui/tests/app_tests.rs"
      ],
      "evidence": [
        "crates/tui/src/app.rs: handle_footer_click uses a hard-coded loading offset (18) and hard-coded column ranges for each tab.",
        "crates/tui/src/app.rs: footer text includes format!(\" Loading... {:.0}% \", self.progress * 100.0) whose width varies (0% vs 100%), so the fixed offset can mis-route clicks.",
        "crates/tui/src/app.rs tests: test_handle_mouse_footer_click covers only one static geometry and does not cover loading/progress or narrow widths."
      ],
      "plan": [
        "Compute footer click targets from the actual rendered spans/strings (or a shared footer model) instead of fixed column math.",
        "Add tests for click routing when loading is true at multiple progress values (0/9/10/100).",
        "Ensure behavior is stable on small terminal widths (gracefully disable click targets when truncated)."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0110",
      "status": "todo",
      "title": "Add a visible cursor + basic line editing for Search query input",
      "priority": "medium",
      "tags": [
        "tui",
        "ux",
        "search",
        "keybindings"
      ],
      "scope": [
        "crates/tui/src/app.rs",
        "crates/tui/src/ui/screens/search.rs",
        "crates/tui/tests/snapshot_tests.rs"
      ],
      "evidence": [
        "crates/tui/src/ui/screens/search.rs: renders the query text but does not place a terminal cursor or show caret position, making text entry feel opaque.",
        "crates/tui/src/app.rs: search_input is a plain String with backspace-only editing; no cursor position tracking exists.",
        "Repo-wide search: no uses of Frame::set_cursor, indicating cursor is never displayed."
      ],
      "plan": [
        "Track a cursor index for Search query input (and any future text inputs) and render the cursor with Frame::set_cursor.",
        "Implement minimal editing keys (Left/Right, Home/End for line, Backspace/Delete) without conflicting with navigation.",
        "Update snapshots (Search screen) to validate cursor placement in a stable way, and add unit tests for editing behavior."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0111",
      "status": "todo",
      "title": "Fix Search status messaging to reference the actual running query, not current input",
      "priority": "medium",
      "tags": [
        "tui",
        "ux",
        "search",
        "bug"
      ],
      "scope": [
        "crates/tui/src/app.rs",
        "crates/tui/src/main.rs",
        "crates/tui/tests/app_tests.rs"
      ],
      "evidence": [
        "crates/tui/src/app.rs: Action::SearchComplete sets search_status using self.search_input, which can be edited while a search is running.",
        "crates/tui/src/main.rs: Action::RunSearch captures query_clone for the running job, so the app already has a stable query string that can be stored/displayed.",
        "crates/tui/src/app.rs: search_status is set to \"Running: {query}\" at submit time, but completion uses the (possibly changed) current input."
      ],
      "plan": [
        "Introduce an explicit field for the active/running query and use it for status lines and completion summaries.",
        "Add tests that modify search_input while loading and assert status still references the submitted query.",
        "Ensure this integrates with the redesigned Search input mode."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0112",
      "status": "todo",
      "title": "Repair Search results viewport math (result-count vs line-count) and scrolling semantics",
      "priority": "medium",
      "tags": [
        "tui",
        "ux",
        "search",
        "rendering",
        "bug"
      ],
      "scope": [
        "crates/tui/src/ui/screens/search.rs",
        "crates/tui/src/app.rs",
        "crates/tui/tests/snapshot_tests.rs"
      ],
      "evidence": [
        "crates/tui/src/ui/screens/search.rs: available_height is computed in terminal rows, but visible_end is computed as search_scroll_offset + available_height where search_scroll_offset is treated as a result index.",
        "crates/tui/src/ui/screens/search.rs: each result is pretty-printed and expanded into many Lines, so taking N results can exceed the viewport by an order of magnitude and make scrolling confusing.",
        "crates/tui/src/app.rs: next_item/previous_item adjust search_scroll_offset by 1, implying result-based scrolling rather than line-based, which fights with the multi-line rendering."
      ],
      "plan": [
        "Decide on a consistent scroll model (recommended: line-based scroll for the rendered text, with an optional selected-result index for copy/export actions).",
        "Refactor Search rendering to compute visible window based on lines and apply Paragraph::scroll for performance.",
        "Update navigation keys/tests/snapshots to reflect the new scroll behavior and ensure copy/export uses the intended selection."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0114",
      "status": "todo",
      "title": "Improve Jobs filter UX: Esc cancels edit without clearing existing filter",
      "priority": "medium",
      "tags": [
        "tui",
        "ux",
        "jobs",
        "keybindings"
      ],
      "scope": [
        "crates/tui/src/app.rs",
        "crates/tui/src/ui/screens/jobs.rs",
        "crates/tui/tests/app_tests.rs"
      ],
      "evidence": [
        "crates/tui/src/app.rs: in jobs filtering branch, KeyCode::Esc exits filter mode and returns Action::ClearSearch, which clears any previously applied filter (no way to cancel an edit).",
        "crates/tui/src/ui/screens/jobs.rs: when a filter is applied, UI says \"(Press ESC to clear)\", but the same Esc is also used while actively editing, conflating cancel vs clear.",
        "crates/tui/tests/app_tests.rs: filter tests focus on apply/clear flows but do not cover cancel-edit semantics."
      ],
      "plan": [
        "Track a previous filter value when entering filter edit mode so Esc can revert/cancel without clearing.",
        "Reserve a distinct keybinding for clearing the applied filter (e.g., Ctrl+Esc or a dedicated \"clear\" key).",
        "Update UI hint text and add tests for cancel vs clear."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0113",
      "status": "todo",
      "title": "Make Help and Docs consistent with runtime behavior (post-keymap change)",
      "priority": "medium",
      "tags": [
        "tui",
        "docs",
        "ux",
        "keybindings"
      ],
      "scope": [
        "docs/usage.md",
        "crates/tui/src/ui/popup.rs",
        "crates/tui/tests/snapshot_tests.rs",
        "make ci"
      ],
      "evidence": [
        "docs/usage.md: documents q Quit, e Export, and 0-9 navigation as primary controls; current runtime is already inconsistent (quit does not exit) and will change as keymap is redesigned.",
        "crates/tui/src/ui/popup.rs: duplicates the same keybinding documentation as a static string, which can drift from code and from docs/usage.md.",
        "crates/tui/tests/snapshot_tests.rs: snapshot_help_popup asserts a specific help rendering, requiring coordinated updates as help content changes."
      ],
      "plan": [
        "After implementing the new keymap, update docs/usage.md TUI section to exactly match runtime behavior.",
        "Ensure in-app help is generated from the same source of truth as docs (or at least kept in sync by tests).",
        "Run make ci and visually review help + docs for completeness."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0117",
      "status": "todo",
      "title": "Add a future-proof keybinding configuration story (optional, post-stabilization)",
      "priority": "low",
      "tags": [
        "tui",
        "ux",
        "keybindings",
        "config",
        "future"
      ],
      "scope": [
        "crates/config/",
        "crates/tui/src/app.rs",
        "docs/usage.md"
      ],
      "evidence": [
        "Current keybindings are hard-coded across App input handlers and the help popup text, making iteration risky and user customization impossible.",
        "Splunk TUI already persists some UI state (theme, history, sort) and has a config system; keybinds could follow similar patterns once stabilized."
      ],
      "plan": [
        "After stabilizing the default keymap, design a minimal config format for overriding a small subset (quit, help, export, next/prev screen).",
        "Implement config loading/validation in crates/config with safe defaults and clear error messages.",
        "Document customization in docs/usage.md and add tests for config parsing and fallback behavior."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T04:26:05Z",
      "updated_at": "2026-01-27T04:26:05Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0137",
      "status": "todo",
      "title": "Add runtime profile switching in TUI (re-auth + reload without restarting)",
      "priority": "low",
      "tags": [
        "tui",
        "distributed",
        "config"
      ],
      "scope": [
        "crates/tui/src/main.rs",
        "crates/tui/src/app.rs",
        "crates/config/src/persistence.rs",
        "docs/usage.md",
        "crates/tui/tests/"
      ],
      "evidence": [
        "crates/tui/src/main.rs supports selecting a profile only at startup via SPLUNK_PROFILE; changing environments requires restarting the app.",
        "crates/config/src/persistence.rs supports multiple named profiles, and CLI supports --profile selection, so TUI lacks parity for multi-env workflows.",
        "For Splunk admins managing multiple instances, switching environments is a core distributed-environment UX need."
      ],
      "plan": [
        "Add a Settings workflow to list profiles and select an active profile at runtime.",
        "Rebuild the client (and re-auth if needed) when profile changes; clear or reload screen data safely.",
        "Show the active profile prominently (pair with RQ-0134 connection banner).",
        "Add tests covering profile switching success/failure and state reset behavior."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T16:39:47Z",
      "updated_at": "2026-01-27T16:39:47Z",
      "depends_on": [],
      "custom_fields": {}
    },
    {
      "id": "RQ-0139",
      "status": "todo",
      "title": "Add multi-profile list-all aggregation (distributed visibility across environments)",
      "priority": "low",
      "tags": [
        "cli",
        "distributed",
        "ux"
      ],
      "scope": [
        "crates/cli/src/commands/list_all.rs",
        "crates/cli/src/main.rs",
        "crates/config/",
        "docs/usage.md",
        "make test -p splunk-cli"
      ],
      "evidence": [
        "crates/cli/src/commands/list_all.rs is explicitly labeled a \"minimal working version\" and operates against a single resolved config/profile.",
        "The repo supports multiple profiles (crates/config/src/persistence.rs) but there is no CLI workflow to summarize multiple environments in one invocation.",
        "list_all.rs uses a custom timestamp string (secs.nsecsZ) rather than a standard RFC3339 timestamp, which is a UX/interop footgun when aggregating results."
      ],
      "plan": [
        "Add a CLI option to run list-all across multiple profiles (e.g., --profiles a,b,c or --all-profiles).",
        "Aggregate per-profile results with a clear table/JSON schema (profile name, base_url, per-resource status).",
        "Upgrade timestamps to RFC3339 and document the schema in docs/usage.md.",
        "Add integration tests using temporary config files and mocked endpoints/live-test gating as appropriate."
      ],
      "notes": [],
      "request": "scan finding",
      "created_at": "2026-01-27T16:39:47Z",
      "updated_at": "2026-01-27T16:39:47Z",
      "depends_on": [],
      "custom_fields": {}
    }
  ]
}